# Supernova Explosion in Turbulent Interstellar medium in galaxies

**One line description of the data:** 
Blastwave in dense cool gas cloud

**Longer description of the data:** 

**Associated paper**: [[Hirashima et al. 2023a](https://academic.oup.com/mnras/article/526/3/4054/7316686), [Hirashima et al. 2023b](https://arxiv.org/abs/2311.08460)]

**Domain scientist**: Keiya Hirashima (The University of Tokyo/CCA) [[WEBSITE](https://kyafuk.github.io/utokyo-hirashima/index.html)]


**Code or software used to generate the data**:
**Code or software used to generate the data**: ASURA-FDPS (Smoothed Particle Hydrodynamics) [[Github](https://github.com/FDPS/FDPS), TBA]

**Equation**:

$\begin{align}
P&=(\gamma-1) \rho u \\
\frac{d \rho}{dt} &= -\rho \nabla \cdot \mathbf{v} \\
\frac{d^2 \mathbf{r}}{dt^2}  &= -\frac{\nabla P}{\rho} + \mathbf{a}_{\rm visc}-\nabla \Phi \\
\frac{d u}{dt} &= -\frac{P}{\rho} \nabla \cdot \mathbf{v} + \frac{\Gamma-\Lambda}{\rho}
\end{align}$

where $P$, $\rho$, and $u$ are the pressure. $r$ is the position, $a_{\rm visc}$ is the acceleration generated by the viscosity, $\Phi$ is the gravitational potential, $\Gamma$ is the radiative heat influx per unit volume, and $\Lambda$ is the radiative heat outflux per unit volume.

<img src="SN_6panels.gif" width="500">

# About the data

Dimension of discretized data: $59\times 64\times 64\times 64$ (Cubes of $64\times 64\times 64$ with 59 timesteps).



Fields available in the data: ['pressure', 'Vx', 'Vy', 'Vz', 'density', 'temperature']

Number of trajectories:

|           | 1M $_\odot$ | 0.1 M $\odot$ |
|----------|:----------:|:----------:|
| **$64^3$** | 500 | 260 |
| **$128^3$** | - | 60 |


Estimated size of the ensemble of all simulations:
|           | 1M $_\odot$ | 0.1 M $\odot$ |
|----------|:----------:|:----------:|
| **$64^3$** | $173$ GB | $83$ GB |
| **$128^3$** | - | $168$ GB |

Grid type: Uniform grid

Initial conditions:
Initial conditions: $820$ random seeds generated using https://github.com/amusecode/amuse/blob/main/src/amuse/ext/molecular_cloud.py (Virialized isothermal gas sphere with turbulence following the velocity spectrum $E(k) \propto k^{-2}$, which is Burgers turbulence ([Burgers 1948](https://www.sciencedirect.com/science/article/abs/pii/S0065215608701005) and [Kupilas+2021](https://doi.org/10.1093/mnras/staa3889) for reference [ADD IT KEIYA]))

Boundary conditions: Open boundary condition.

Simulation time-step:

Data are stored separated by ($\Delta t$): $100$~$10,000$ years (variable timesteps)

Total time range ($t_{min}$ to $t_{max}$):$0$ yr to $0.2$ Myr

Spatial domain size ($L_x$, $L_y$, $L_z$): 60 pc

Set of coefficients or non-dimensional parameters evaluated: Initial temperature $T_0$=\{100K\}, Initial number density of hydrogen $\rho_0=$\{44.5/cc\}, metallicity (effectively strength of cooling) $Z=\{Z_0\}$

Approximate time to generate the data (CPU hours):
| 1M $_\odot$ | 0.1 M $\odot$ |
|:----------:|:----------:|
| $300$ | $3500$ |

Hardware used to generate the data and precision used for generating the data: up to 1040 CPU cores per run.




# What is interesting and challenging about the data:

What phenomena of physical interest are catpured in the data:
The simulations are designed as an supernova explosion, which is the explosion at the last moment of massive stars, in a high-density starforming molecular cloud with a large density contrast. An adiabatic compression of a monatomic ideal gas is assumed.
To mimic the explosion, the huge thermal energy ($10^{51}$ erg) is injected at the center of the calculation box and going to make the blastwave, which sweeps out the ambient gas and shells called as supernova feedback. These interactions between supernovae and surrounding gas are interesting because stars are formed in dense and cold regions.

However, calclatig the propagation of blastwaves requires tiny timesteps to calculate and numerous integration steps. When supernova feedback is incorporated in a galaxy simulation, some functions fitted using local high resolution simulations have been used.

How to evaluate a new simulator operating in this space:
In context of galaxy simulations, the time evolution of thermal energy and momentum are important. We note that those physical quantities are not necessarily conserved because radiative cooling and heating are considered and thermal energy is seamlessly being converted into momentum.